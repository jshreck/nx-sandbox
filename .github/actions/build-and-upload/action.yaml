name: 'Build and Upload App'
description: 'Builds a specified app and uploads its build artifacts.'
inputs:
  app-name:
    description: 'The name of the app to build.'
    required: true
  build-folder:
    description: 'The folder containing the build output.'
    required: false
    default: 'dist'
runs:
  using: 'composite'
  steps:
    - name: Build website
      run: npx nx run ${{ inputs.app-name }}:build
      shell: bash
    - name: Zip build output
      run: |
        cd apps/${{ inputs.app-name }}/${{ inputs.build-folder }}
        zip -r ../${{ inputs.app-name }} .
      shell: bash
    - name: Upload artifacts
      uses: actions/upload-artifact@v4
      with:
        name: ${{ inputs.app-name }}
        path: apps/${{ inputs.app-name }}/${{ inputs.app-name }}
    - name: Delete zip file
      run: rm apps/${{ inputs.app-name }}/${{ inputs.app-name }}
      shell: bash
    - name: Set output file name
      id: set_output
      run: |
        echo "file-name=${{ inputs.app-name }}" >> $GITHUB_OUTPUT
      shell: bash
outputs:
  file-name:
    value: ${{ steps.set_output.outputs.file-name }}
    description: 'The name of the zipped artifact file.'
